<!DOCTYPE html>
<html lang="zh-Hant" xmlns:th="http://www.thymeleaf.org" th:replace="layout :: html">
<head>
  <title>進口貨物流程序平台</title>
</head>
<section>
  <ul class="nav nav-pills mb-3" id="flowTabs" role="tablist">
    <li class="nav-item" role="presentation">
      <button class="nav-link active" data-bs-toggle="pill" data-bs-target="#t1" type="button">1. 到貨通知</button>
    </li>
    <li class="nav-item" role="presentation">
      <button class="nav-link" data-bs-toggle="pill" data-bs-target="#t2" type="button">2. 報關文件彙整</button>
    </li>
    <li class="nav-item" role="presentation">
      <button class="nav-link" data-bs-toggle="pill" data-bs-target="#t3" type="button">3. 貨物報關</button>
    </li>
    <li class="nav-item" role="presentation">
      <button class="nav-link" data-bs-toggle="pill" data-bs-target="#t4" type="button">4. 入廠驗收作業</button>
    </li>
    <li class="nav-item" role="presentation">
      <button class="nav-link" data-bs-toggle="pill" data-bs-target="#t5" type="button">5. 帳務管理</button>
    </li>
  </ul>

  <div class="tab-content">
    <!-- t1 -->
    <div class="tab-pane fade show active" id="t1">
      <div class="card shadow-sm">
        <div class="card-header bg-white"><strong>到貨資料建立</strong></div>
        <div class="card-body">
          <form th:action="@{/flow/arrival}" th:object="${arrival}" method="post" enctype="multipart/form-data" novalidate>
            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
            <div class="row g-3">
              <div class="col-md-6">
                <label class="form-label">Forwarder/供應商</label>
                <input class="form-control" th:field="*{party}"/>
                <div class="text-danger small" th:if="${#fields.hasErrors('party')}" th:errors="*{party}"></div>
              </div>
              <div class="col-md-6">
                <label class="form-label">提單/空運單號</label>
                <input class="form-control" th:field="*{blOrAwb}"/>
                <div class="text-danger small" th:if="${#fields.hasErrors('blOrAwb')}" th:errors="*{blOrAwb}"></div>
              </div>
              <div class="col-md-6">
                <label class="form-label">航班/船名航次</label>
                <input class="form-control" th:field="*{voyage}"/>
              </div>
              <div class="col-md-6">
                <label class="form-label">預計到港/到機日期</label>
                <input type="date" class="form-control" th:field="*{eta}"/>
                <div class="text-danger small" th:if="${#fields.hasErrors('eta')}" th:errors="*{eta}"></div>
              </div>
              <div class="col-md-6">
                <label class="form-label">目的地倉庫</label>
                <input class="form-control" th:field="*{warehouse}"/>
              </div>
              <div class="col-md-6">
                <label class="form-label">通知對象</label>
                <input class="form-control" th:field="*{notifyTo}"/>
              </div>
              <div class="col-12">
                <label class="form-label">到貨通知附件</label>
                <input type="file" class="form-control" name="arrivalFiles" multiple/>
              </div>
              <div class="col-12">
                <label class="form-label">備註</label>
                <textarea class="form-control" rows="3" th:field="*{remarks}"></textarea>
              </div>
            </div>
            <div class="mt-3 d-flex gap-2">
              <button type="submit" class="btn btn-primary">發送通知</button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- t2 -->
    <div class="tab-pane fade" id="t2">
      <div class="card shadow-sm">
        <div class="card-header bg-white"><strong>報關文件上傳與校對</strong></div>
        <div class="card-body">
          <form th:action="@{/flow/docs}" th:object="${docs}" method="post" enctype="multipart/form-data" novalidate>
            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
            <div class="row g-3">
              <div class="col-md-4">
                <label class="form-label">商業發票</label>
                <input type="file" class="form-control" name="invoiceFile"/>
              </div>
              <div class="col-md-4">
                <label class="form-label">裝箱單</label>
                <input type="file" class="form-control" name="packingFile"/>
              </div>
              <div class="col-md-4">
                <label class="form-label">提單</label>
                <input type="file" class="form-control" name="blFile"/>
              </div>
              <div class="col-md-3">
                <label class="form-label">幣別</label>
                <select class="form-select" th:field="*{currency}">
                  <option>USD</option><option>TWD</option><option>EUR</option><option>JPY</option>
                </select>
                <div class="text-danger small" th:if="${#fields.hasErrors('currency')}" th:errors="*{currency}"></div>
              </div>
              <div class="col-md-3">
                <label class="form-label">發票總額</label>
                <input type="number" step="0.01" class="form-control" th:field="*{invoiceTotal}"/>
              </div>
              <div class="col-12">
                <label class="form-label">備註/校對記錄</label>
                <textarea class="form-control" rows="3" th:field="*{notes}"></textarea>
              </div>
            </div>
            <div class="mt-3 d-flex gap-2">
              <button class="btn btn-primary" type="submit">指派報關行</button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- t3 -->
    <div class="tab-pane fade" id="t3">
      <div class="card shadow-sm">
        <div class="card-header bg-white"><strong>申報資訊</strong></div>
        <div class="card-body">
          <form th:action="@{/flow/decl}" th:object="${decl}" method="post" enctype="multipart/form-data" novalidate>
            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
            <div class="row g-3">
              <div class="col-md-4">
                <label class="form-label">報單號碼</label>
                <input class="form-control" th:field="*{entryNo}"/>
                <div class="text-danger small" th:if="${#fields.hasErrors('entryNo')}" th:errors="*{entryNo}"></div>
              </div>
              <div class="col-md-4">
                <label class="form-label">通關制別</label>
                <select class="form-select" th:field="*{regime}">
                  <option>一般報關</option><option>保稅區進出</option><option>暫時進口</option><option>保固/維修</option>
                </select>
                <div class="text-danger small" th:if="${#fields.hasErrors('regime')}" th:errors="*{regime}"></div>
              </div>
              <div class="col-md-4">
                <label class="form-label">通關狀態</label>
                <select class="form-select" th:field="*{status}">
                  <option>待申報</option><option>已申報</option><option>抽查/檢驗</option><option>已放行</option>
                </select>
                <div class="text-danger small" th:if="${#fields.hasErrors('status')}" th:errors="*{status}"></div>
              </div>
              <div class="col-md-4">
                <label class="form-label">應稅金額</label>
                <input type="number" step="0.01" class="form-control" th:field="*{duties}"/>
              </div>
              <div class="col-12">
                <label class="form-label">關稅/稅費明細</label>
                <textarea class="form-control" rows="3" th:field="*{dutyDetail}"></textarea>
              </div>
              <div class="col-12">
                <label class="form-label">報關附件（報單、收據）</label>
                <input type="file" class="form-control" name="declFiles" multiple/>
              </div>
            </div>
            <div class="mt-3 d-flex gap-2">
              <button class="btn btn-primary" type="submit">更新狀態</button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- t4 -->
    <div class="tab-pane fade" id="t4">
      <div class="card shadow-sm">
        <div class="card-header bg-white"><strong>驗收紀錄</strong></div>
        <div class="card-body">
          <form th:action="@{/flow/recv}" th:object="${recv}" method="post" enctype="multipart/form-data" novalidate>
            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
            <div class="row g-3">
              <div class="col-md-4">
                <label class="form-label">收料單號</label>
                <input class="form-control" th:field="*{grNo}"/>
                <div class="text-danger small" th:if="${#fields.hasErrors('grNo')}" th:errors="*{grNo}"></div>
              </div>
              <div class="col-md-4">
                <label class="form-label">驗收日期</label>
                <input type="date" class="form-control" th:field="*{receivedDate}"/>
                <div class="text-danger small" th:if="${#fields.hasErrors('receivedDate')}" th:errors="*{receivedDate}"></div>
              </div>
              <div class="col-md-4">
                <label class="form-label">驗收人員</label>
                <input class="form-control" th:field="*{person}"/>
                <div class="text-danger small" th:if="${#fields.hasErrors('person')}" th:errors="*{person}"></div>
              </div>
              <div class="col-md-4">
                <label class="form-label">驗收結果</label>
                <select class="form-select" th:field="*{result}"><option>合格</option><option>不合格</option><option>部分合格</option></select>
                <div class="text-danger small" th:if="${#fields.hasErrors('result')}" th:errors="*{result}"></div>
              </div>
              <div class="col-12">
                <label class="form-label">缺失/說明</label>
                <textarea class="form-control" rows="3" th:field="*{issueNote}"></textarea>
              </div>
              <div class="col-12">
                <label class="form-label">照片/證明</label>
                <input type="file" class="form-control" name="recvFiles" multiple/>
              </div>
            </div>
            <div class="mt-3 d-flex gap-2">
              <button class="btn btn-primary" type="submit">提交驗收</button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- t5 -->
    <div class="tab-pane fade" id="t5">
      <div class="card shadow-sm">
        <div class="card-header bg-white"><strong>應付與上傳</strong></div>
        <div class="card-body">
          <form th:action="@{/flow/acct}" th:object="${acct}" method="post" enctype="multipart/form-data" novalidate>
            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
            <div class="row g-3">
              <div class="col-md-6">
                <label class="form-label">供應商/報關行</label>
                <input class="form-control" th:field="*{vendor}"/>
                <div class="text-danger small" th:if="${#fields.hasErrors('vendor')}" th:errors="*{vendor}"></div>
              </div>
              <div class="col-md-6">
                <label class="form-label">應付發票號碼</label>
                <input class="form-control" th:field="*{apNo}"/>
                <div class="text-danger small" th:if="${#fields.hasErrors('apNo')}" th:errors="*{apNo}"></div>
              </div>
              <div class="col-md-3">
                <label class="form-label">金額</label>
                <input type="number" step="0.01" class="form-control" th:field="*{amount}"/>
              </div>
              <div class="col-md-3">
                <label class="form-label">幣別</label>
                <select class="form-select" th:field="*{currency}"><option>USD</option><option>TWD</option><option>EUR</option><option>JPY</option></select>
              </div>
              <div class="col-md-3">
                <label class="form-label">匯率</label>
                <input type="number" step="0.0001" class="form-control" th:field="*{rate}"/>
              </div>
              <div class="col-md-3">
                <label class="form-label">ERP 上傳狀態</label>
                <select class="form-select" th:field="*{erpStatus}"><option>未上傳</option><option>已上傳</option><option>失敗</option></select>
              </div>
              <div class="col-12">
                <label class="form-label">付款附件（Invoice/收據）</label>
                <input type="file" class="form-control" name="acctFiles" multiple/>
              </div>
              <div class="col-12">
                <label class="form-label">備註</label>
                <textarea class="form-control" rows="3" th:field="*{memo}"></textarea>
              </div>
            </div>
            <div class="mt-3 d-flex gap-2">
              <button class="btn btn-primary" type="submit">匯出/上傳 ERP</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</section>
